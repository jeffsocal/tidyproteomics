<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tidyproteomics: simplified data object and analysis functions
">
<title>Protein Accounting • tidyproteomics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Protein Accounting">
<meta property="og:description" content="tidyproteomics: simplified data object and analysis functions
">
<meta property="og:image" content="https://jeffsocal.github.io/tidyproteomics/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tidyproteomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-object.html">the tidyproteomics data-object</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Operations</h6>
    <a class="dropdown-item" href="../articles/importing.html">Importing</a>
    <a class="dropdown-item" href="../articles/summarizing.html">Summarizing</a>
    <a class="dropdown-item" href="../articles/subsetting.html">Subsetting</a>
    <a class="dropdown-item" href="../articles/normalizing.html">Normalizing</a>
    <a class="dropdown-item" href="../articles/imputing.html">Imputing</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Analysis</h6>
    <a class="dropdown-item" href="../articles/visualizing.html">Visualizing</a>
    <a class="dropdown-item" href="../articles/expression.html">Expression</a>
    <a class="dropdown-item" href="../articles/enrichment.html">Enrichment</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Workflows</h6>
    <a class="dropdown-item" href="../articles/workflow-simple.html">Simple</a>
    <a class="dropdown-item" href="../articles/workflow-publication.html">Publication Demo</a>
    <a class="dropdown-item" href="../articles/protein-inferencing.html">Protein Inferencing</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/updates.html">update history</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Protein Accounting</h1>
            
      
      
      <div class="d-none name"><code>protein-inferencing.Rmd</code></div>
    </div>

    
    
<p>Protein accounting is an important aspect of quantiative proteomics.
It consists of aggregating individual peptide measurements into a single
reported protein. However, sequence homology make this a less than
trivial process, as the LCMS process does not identify proteins
specifically, rather their individual peptide segments. It is then up to
the researcher to implement a method that infers the original protein
content.</p>
<p>While the proteomics community at large has devised several schemes
for protein accounting, not all methods are universally amenable. For
example, when accounting for cellular differences between to cell
states, it is often preferred to arrive at the minimal number of protein
sequences that can explain the data. That means tossing aside
identifiers to sequence variants - something researchers attempting to
identify specific genes might like to retain. Furthermore, for
researchers attempting to grasp if gene insertions are viable, gross
summation of peptide abundances may miss nuances in sequence variations.
These latter points are not well controlled for in platforms that cater
for proteome wide discoveries. Therefor, we have attempted to provide
several simple mechanisms that can apply to a variety of LCMS proteomics
projects both larger proteome wide discoveries and smaller induced
expression projects.</p>
<p>More sophisticated methods of protein accounting should utilize those
current implementations, export the quantitative protein level data and
then import into tidyproteomics.</p>
<div class="section level2">
<h2 id="the-inputs">The inputs<a class="anchor" aria-label="anchor" href="#the-inputs"></a>
</h2>
<p>The <code><a href="../reference/collapse.html">collapse()</a></code> function accommodates four methods for
accounting with the variable <code>assign_by</code>:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>all-possible</td>
<td>retain all protein assignments regardless of homology</td>
</tr>
<tr class="even">
<td>non-homologous</td>
<td>retain all protein assignments, but only use quantitative values
from peptides that identify a single unique protein.</td>
</tr>
<tr class="odd">
<td>razor-local</td>
<td>peptide will be assigned to the protein group with the largest
number of total peptides identified within a sample group</td>
</tr>
<tr class="even">
<td>razor-global</td>
<td>peptide will be assigned to the protein group with the largest
number of total peptides identified globally</td>
</tr>
</tbody>
</table>
<p>The <code>top_n</code> variable sets the number of peptide
quantitative values to include in the final protein quantitative
value.</p>
<p>The <code>split_abundance</code> true/false variable, if true, will
split abundances of razor-peptides by the proportional abundance between
proteins. This method is experimental, has not been validated or
peer-reviewed.</p>
<p>A <code>fasta_path</code> can be provided to calculate iBAQ based
values. However, currently this method only supports Tryptic based
peptide accounting.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="assign-to-all-possible-proteins-sum-top-5-quantitative-values">Assign to all-possible proteins, sum top-5 quantitative values<a class="anchor" aria-label="anchor" href="#assign-to-all-possible-proteins-sum-top-5-quantitative-values"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pro_frompep_razor</span> <span class="op">&lt;-</span> <span class="va">pep_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="../reference/collapse.html">collapse</a></span><span class="op">(</span>assign_by <span class="op">=</span> <span class="st">'razor-global'</span>, top_n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/normalize.html">normalize</a></span><span class="op">(</span>.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'median'</span>, <span class="st">'linear'</span>, <span class="st">'loess'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pro_frompep_razor</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="st">"sample"</span>, destination <span class="op">=</span> <span class="st">'return'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sample'</span>, <span class="st">'proteins'</span>, <span class="st">'peptides'</span>, <span class="st">'CVs'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   sample proteins peptides   CVs</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ctl        <span style="text-decoration: underline;">7</span>056    <span style="text-decoration: underline;">63</span>622 0.159</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> p97_kd     <span style="text-decoration: underline;">7</span>056    <span style="text-decoration: underline;">63</span>622 0.209</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-to-proteomediscoverers-protein-accounting">Compare to ProteomeDiscoverer’s Protein Accounting<a class="anchor" aria-label="anchor" href="#compare-to-proteomediscoverers-protein-accounting"></a>
</h3>
<pre><code>#&gt; Warning:  [1m [22mOne or more parsing issues, call `problems()` on your data frame for details,
#&gt; e.g.:
#&gt;   dat &lt;- vroom(...)
#&gt;   problems(dat)
#&gt;  [36mℹ [39m Importing  [34m [3m [34mProteomeDiscoverer [34m [23m [39m:
#&gt;  [36mℹ [39m ...  [3m [34mp97KD_HCT116_proteins.xlsx [39m [23m
#&gt;  [36mℹ [39m ... extracting  [34m [3m [34m(?&lt;=(Control|Sample)\,\s).+ [34m [23m [39m from  [34m [3m [34m [3maccounting [3m ~  [3msample [3m [34m [23m [39m
#&gt;  [36mℹ [39m ...  [3m [34mp97KD_HCT116_proteins.xlsx [39m [23m
 [36mℹ [39m ... extracting  [34m [3m [34m(?&lt;=\s)F\d+(\:\s\d+[CN]*)* [34m [23m [39m from  [34m [3m [34m [3maccounting [3m ~  [3msample_file [3m [34m [23m [39m
#&gt;  [36mℹ [39m ...  [3m [34mp97KD_HCT116_proteins.xlsx [39m [23m
 [36mℹ [39m ... split  [34m [3m [34mprotein [34m [23m [39m with  [34m [3m [34m\; [34m [23m [39m not detected
#&gt;  [36mℹ [39m ...  [3m [34mp97KD_HCT116_proteins.xlsx [39m [23m
 [36mℹ [39m ... no homology detected
#&gt;  [36mℹ [39m ...  [3m [34mp97KD_HCT116_proteins.xlsx [39m [23m
 [36mℹ [39m ... match between runs accounting for  [34m [3m [34m [3m3.58 [3m% [34m [23m [39m of data
#&gt;  [36mℹ [39m ...  [3m [34mp97KD_HCT116_proteins.xlsx [39m [23m
 [33m! [39m ... not all `annotation` columns imported, missing  [38;5;202m [3m [38;5;202mchromosome [38;5;202m [23m [39m and  [38;5;202m [3m [38;5;202mkegg_pathway [38;5;202m [23m [39m
#&gt;  [36mℹ [39m ...  [3m [34mp97KD_HCT116_proteins.xlsx [39m [23m
 [32m✔ [39m ...  [3m [34mp97KD_HCT116_proteins.xlsx [39m [23m  [38;5;249m[2.2s] [39m
#&gt; 
#&gt;  [36mℹ [39m Normalizing quantitative data
#&gt;  [36mℹ [39m ... using  [34mmedian shift [39m
#&gt;  [32m✔ [39m ... using  [34mmedian shift [39m  [38;5;249m[225ms] [39m
#&gt; 
#&gt;  [36mℹ [39m ... using  [34mlinear regression [39m
#&gt;  [32m✔ [39m ... using  [34mlinear regression [39m  [38;5;249m[311ms] [39m
#&gt; 
#&gt;  [36mℹ [39m ... using  [34mloess regression [39m
#&gt;  [32m✔ [39m ... using  [34mloess regression [39m  [38;5;249m[1.2s] [39m
#&gt; 
#&gt;  [36mℹ [39m Selecting best normalization method
#&gt;  [32m✔ [39m Selecting best normalization method ... done
#&gt; 
#&gt;  [36mℹ [39m  ... selected  [34m [3m [34mloess [34m [23m [39m</code></pre>
<p>Check to see how the two results agree …</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_merged_razor</span> <span class="op">&lt;-</span> <span class="va">pro_frompep_razor</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="st">'sample'</span>,<span class="st">'replicate'</span>,<span class="st">'protein'</span>, <span class="st">'abundance_raw'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">pro_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="st">'sample'</span>,<span class="st">'replicate'</span>,<span class="st">'protein'</span>, <span class="st">'abundance_raw'</span><span class="op">)</span>, </span>
<span>             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sample'</span>,<span class="st">'replicate'</span>,<span class="st">'protein'</span><span class="op">)</span>,</span>
<span>             suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_tidyproteomics"</span>, <span class="st">"_proteomediscoverer"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl_merged_razor</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>itentical_protein_abundances <span class="op">=</span> <span class="va">abundance_raw_proteomediscoverer</span> <span class="op">==</span> <span class="va">abundance_raw_tidyproteomics</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">itentical_protein_abundances</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">itentical_protein_abundances</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">'drop'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>r <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   itentical_protein_abundances     n      r</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE                          812 0.026<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE                         <span style="text-decoration: underline;">29</span>345 0.973</span></span></code></pre></div>
<p>A quick plot for visualizing the</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_merged_razor</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>sample_rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">sample</span>, <span class="va">replicate</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">abundance_raw_proteomediscoverer</span>, <span class="va">abundance_raw_tidyproteomics</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.67</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">sample_rep</span><span class="op">)</span></span></code></pre></div>
<p><img src="protein-inferencing_files/figure-html/unnamed-chunk-7-1.png" width="700">
Lets look at a few examples of outliers …</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_merged_razor</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">abundance_raw_proteomediscoverer</span> <span class="op">!=</span> <span class="va">abundance_raw_tidyproteomics</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   sample replicate protein abundance_raw_tidyproteomics abundance_raw_proteome…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> p97_kd 1         P45983                      1<span style="text-decoration: underline;">699</span>445.                 1<span style="text-decoration: underline;">409</span>719.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> p97_kd 1         Q969Z3                      1<span style="text-decoration: underline;">917</span>176.                 1<span style="text-decoration: underline;">917</span>176.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> p97_kd 1         Q16537                      4<span style="text-decoration: underline;">080</span>608.                 3<span style="text-decoration: underline;">015</span>887.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​abundance_raw_proteomediscoverer</span></span></span></code></pre></div>
<p>We will take the protein <strong>P45983</strong> to examine …</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pep_P45983</span> <span class="op">&lt;-</span> <span class="va">pep_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op">==</span> <span class="st">'P45983'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pep_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">peptide</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pep_P45983</span><span class="op">$</span><span class="va">peptide</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">peptide</span>, <span class="va">modifications</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    proteins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">protein</span>, collapse <span class="op">=</span> <span class="st">"; "</span><span class="op">)</span>,</span>
<span>    abundance_raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   peptide [5]</span></span></span>
<span><span class="co">#&gt;   peptide                             modifications           proteins   abund…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> [K].VIEQLGTPCPEFMK.[K]              1xCarbamidomethyl [C9]  P45983      5.67<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> [K].YAGYSFEK.[L]                    <span style="color: #BB0000;">NA</span>                      P45983      4.26<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> [KR].IIDFGLAR.[THRQ]                <span style="color: #BB0000;">NA</span>                      O15264; Q…  3.43<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> [R].ISVDEALQHPYINVWYDPSEAEAPPPK.[I] <span style="color: #BB0000;">NA</span>                      P45983      4.17<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> [R].MSYLLYQMLCGIK.[H]               1xCarbamidomethyl [C10] P45984; P…  2.90<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​abundance_raw</span></span></span></code></pre></div>
<p>Here we see that <strong>P45983</strong> yielded 5 peptides, 2 of
which are shared. In the outlier table we see that ProteomeDiscoverer
excluded all razor peptides from the protein quantitation. And if we dig
further, we find that the peptide <strong>IIDFGLAR</strong> by razor
definition belongs to the protein <strong>Q16539</strong>, while the
peptide <strong>MSYLLYQMLCGIK</strong> can be assigned to
<strong>P45983</strong>, thus giving us the larger value shown in the
outlier table.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pep_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'O15264'</span>,<span class="st">'Q86YV6'</span>,<span class="st">'P45984'</span>,<span class="st">'P53778'</span>,<span class="st">'Q16539'</span>,<span class="st">'P45983'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">protein</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    n_peptides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">peptide</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n_peptides</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   protein n_peptides</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Q16539           7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P45983           5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P45984           3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> O15264           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Q86YV6           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> P53778           1</span></span></code></pre></div>
<p>That means the ProteomeDiscoverer method for protein accounting
excluded the abundance measurement from all razor peptides. Let try to
do replicate that as well.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pro_frompep_nonhom</span> <span class="op">&lt;-</span> <span class="va">pep_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="../reference/collapse.html">collapse</a></span><span class="op">(</span>assign_by <span class="op">=</span> <span class="st">'non-homologous'</span>, top_n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/normalize.html">normalize</a></span><span class="op">(</span>.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'median'</span>, <span class="st">'linear'</span>, <span class="st">'loess'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pro_frompep_nonhom</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="st">"sample"</span>, destination <span class="op">=</span> <span class="st">'return'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sample'</span>, <span class="st">'proteins'</span>, <span class="st">'peptides'</span>, <span class="st">'CVs'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   sample proteins peptides   CVs</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ctl        <span style="text-decoration: underline;">7</span>056    <span style="text-decoration: underline;">63</span>622 0.163</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> p97_kd     <span style="text-decoration: underline;">7</span>056    <span style="text-decoration: underline;">63</span>622 0.212</span></span></code></pre></div>
<p>Check to see how the two results agree …</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_merged_nonhom</span> <span class="op">&lt;-</span> <span class="va">pro_frompep_nonhom</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="st">'sample'</span>,<span class="st">'replicate'</span>,<span class="st">'protein'</span>, <span class="st">'abundance_raw'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">pro_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="st">'sample'</span>,<span class="st">'replicate'</span>,<span class="st">'protein'</span>, <span class="st">'abundance_raw'</span><span class="op">)</span>, </span>
<span>             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sample'</span>,<span class="st">'replicate'</span>,<span class="st">'protein'</span><span class="op">)</span>,</span>
<span>             suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_tidyproteomics"</span>, <span class="st">"_proteomediscoverer"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl_merged_nonhom</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>itentical_protein_abundances <span class="op">=</span> <span class="va">abundance_raw_proteomediscoverer</span> <span class="op">==</span> <span class="va">abundance_raw_tidyproteomics</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">itentical_protein_abundances</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">itentical_protein_abundances</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">'drop'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>r <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   itentical_protein_abundances     n     r</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE                         <span style="text-decoration: underline;">3</span>448 0.115</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE                         <span style="text-decoration: underline;">26</span>479 0.885</span></span></code></pre></div>
<p>A quick plot for visualizing the</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_merged_nonhom</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>sample_rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">sample</span>, <span class="va">replicate</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">abundance_raw_proteomediscoverer</span>, <span class="va">abundance_raw_tidyproteomics</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.67</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">sample_rep</span><span class="op">)</span></span></code></pre></div>
<p><img src="protein-inferencing_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Interesting, we now show that <strong>P45983</strong> agrees with
ProteomeDiscoverer, yet obviously several others do not</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_merged_nonhom</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op">==</span> <span class="st">'P45983'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   sample replicate protein abundance_raw_tidyproteomics abundance_raw_proteome…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> p97_kd 1         P45983                      1<span style="text-decoration: underline;">409</span>719.                 1<span style="text-decoration: underline;">409</span>719.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> p97_kd 2         P45983                      1<span style="text-decoration: underline;">635</span>934.                 1<span style="text-decoration: underline;">635</span>934.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ctl    1         P45983                       <span style="text-decoration: underline;">535</span>040.                  <span style="text-decoration: underline;">535</span>040.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ctl    2         P45983                       <span style="text-decoration: underline;">703</span>721.                  <span style="text-decoration: underline;">703</span>721.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ctl    3         P45983                       <span style="text-decoration: underline;">494</span>211.                  <span style="text-decoration: underline;">494</span>211.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> p97_kd 3         P45983                      2<span style="text-decoration: underline;">219</span>425.                 2<span style="text-decoration: underline;">219</span>425.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​abundance_raw_proteomediscoverer</span></span></span></code></pre></div>
<p>Lets look at a few examples of outliers …</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_merged_nonhom</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">abundance_raw_proteomediscoverer</span> <span class="op">!=</span> <span class="va">abundance_raw_tidyproteomics</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   sample replicate protein abundance_raw_tidyproteomics abundance_raw_proteome…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> p97_kd 1         Q96LR5                       <span style="text-decoration: underline;">216</span>779.                11<span style="text-decoration: underline;">934</span>777.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> p97_kd 1         Q96EV2                       <span style="text-decoration: underline;">261</span>505.                 1<span style="text-decoration: underline;">488</span>348.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> p97_kd 1         Q5R372                       <span style="text-decoration: underline;">269</span>773.                  <span style="text-decoration: underline;">909</span>042.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​abundance_raw_proteomediscoverer</span></span></span></code></pre></div>
<p>We will take the protein <strong>Q96LR5</strong> to examine …</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pep_Q96LR5</span> <span class="op">&lt;-</span> <span class="va">pep_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op">==</span> <span class="st">'Q96LR5'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pep_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">peptide</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pep_Q96LR5</span><span class="op">$</span><span class="va">peptide</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">peptide</span>, <span class="va">modifications</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    proteins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">protein</span>, collapse <span class="op">=</span> <span class="st">"; "</span><span class="op">)</span>,</span>
<span>    abundance_raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'peptide'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   peptide [4]</span></span></span>
<span><span class="co">#&gt;   peptide                    modifications               proteins        abund…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> [K].DNWSPALTISK.[V-]       <span style="color: #BB0000;">NA</span>                          Q96LR5; P51965…  7.01<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> [K].ELAEITLDPPPNCSAGPK.[G] 1xCarbamidomethyl [C13]     Q96LR5; Q969T4   2.17<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> [R].IYHCNINSQGVICLDILK.[D] 2xCarbamidomethyl [C4; C13] Q96LR5; P51965…  2.54<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> [R].VDDSPSTSGGSSDGDQR.[E]  <span style="color: #BB0000;">NA</span>                          Q96LR5           2.17<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​abundance_raw</span></span></span></code></pre></div>
<p>A quick check on the peptide sum and it appears that
ProteomeDiscoverer ignored razor-peptides all together for this
protein</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pep_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">peptide</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pep_P45983</span><span class="op">$</span><span class="va">peptide</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">peptide</span>, <span class="va">modifications</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    proteins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">protein</span>, collapse <span class="op">=</span> <span class="st">"; "</span><span class="op">)</span>,</span>
<span>    abundance_raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>abundance_sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">#&gt;   abundance_sum</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      5<span style="text-decoration: underline;">125</span>573.</span></span></code></pre></div>
<p>If we examine the other proteins in that group for all the peptides
that may be shared …</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_peptides</span> <span class="op">&lt;-</span> <span class="va">pep_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Q96LR5'</span>,<span class="st">'P51965'</span>,<span class="st">'Q969T4'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pep_data</span><span class="op">$</span><span class="va">quantitative</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">peptide</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">get_peptides</span><span class="op">$</span><span class="va">peptide</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">peptide</span>, <span class="va">modifications</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    proteins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">protein</span>, collapse <span class="op">=</span> <span class="st">"; "</span><span class="op">)</span>,</span>
<span>    abundance_raw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abundance_raw</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'peptide'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   peptide [6]</span></span></span>
<span><span class="co">#&gt;   peptide                    modifications               proteins        abund…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> [K].DNWSPALTISK.[V-]       <span style="color: #BB0000;">NA</span>                          Q96LR5; P51965…  7.01<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> [K].ELADITLDPPPNCSAGPK.[G] 1xCarbamidomethyl [C13]     P51965           2.54<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> [K].ELAEITLDPPPNCSAGPK.[G] 1xCarbamidomethyl [C13]     Q96LR5; Q969T4   2.17<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> [R].DPAAPEPEEQEER.[K]      <span style="color: #BB0000;">NA</span>                          Q969T4           3.71<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> [R].IYHCNINSQGVICLDILK.[D] 2xCarbamidomethyl [C4; C13] Q96LR5; P51965…  2.54<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> [R].VDDSPSTSGGSSDGDQR.[E]  <span style="color: #BB0000;">NA</span>                          Q96LR5           2.17<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​abundance_raw</span></span></span></code></pre></div>
<p>… we see that ProteomeDiscoverer actually assigned the abundances of
razor-peptides. And if we check our results from the merged razor data
we find that to be correct.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_merged_razor</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">'p97_kd'</span>, <span class="va">replicate</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Q96LR5'</span>,<span class="st">'P51965'</span>,<span class="st">'Q969T4'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   sample replicate protein abundance_raw_tidyproteomics abundance_raw_proteome…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> p97_kd 1         Q969T4                       <span style="text-decoration: underline;">371</span>158.                  <span style="text-decoration: underline;">371</span>158.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> p97_kd 1         P51965                      2<span style="text-decoration: underline;">536</span>645.                 2<span style="text-decoration: underline;">536</span>645.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> p97_kd 1         Q96LR5                     11<span style="text-decoration: underline;">934</span>777.                11<span style="text-decoration: underline;">934</span>777.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​abundance_raw_proteomediscoverer</span></span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jeff Jones.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
