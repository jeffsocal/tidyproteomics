<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tidyproteomics: simplified data object and analysis functions
">
<title>Annotating • tidyproteomics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Annotating">
<meta property="og:description" content="tidyproteomics: simplified data object and analysis functions
">
<meta property="og:image" content="https://jeffsocal.github.io/tidyproteomics/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tidyproteomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/updates.html">Updates</a>
    <a class="dropdown-item" href="../articles/data-object.html">The Data-Object</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Operations</h6>
    <a class="dropdown-item" href="../articles/importing.html">Importing</a>
    <a class="dropdown-item" href="../articles/summarizing.html">Summarizing</a>
    <a class="dropdown-item" href="../articles/subsetting.html">Subsetting</a>
    <a class="dropdown-item" href="../articles/normalizing.html">Normalizing</a>
    <a class="dropdown-item" href="../articles/imputing.html">Imputing</a>
    <a class="dropdown-item" href="../articles/annotating.html">Annotating</a>
    <a class="dropdown-item" href="../articles/collapsing.html">Protein Accounting</a>
    <a class="dropdown-item" href="../articles/extracting.html">Extracting</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Analysis</h6>
    <a class="dropdown-item" href="../articles/visualizing.html">Visualizing</a>
    <a class="dropdown-item" href="../articles/expression.html">Expression</a>
    <a class="dropdown-item" href="../articles/enrichment.html">Enrichment</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Workflows</h6>
    <a class="dropdown-item" href="../articles/workflow-simple.html">Simple</a>
    <a class="dropdown-item" href="../articles/workflow-importing.html">Importing Demo</a>
    <a class="dropdown-item" href="../articles/workflow-userimport.html">User Defined Import</a>
    <a class="dropdown-item" href="../articles/workflow-publication.html">Publication Demo</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Annotating</h1>
            
      
      
      <div class="d-none name"><code>annotating.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="annotating-data">Annotating data<a class="anchor" aria-label="anchor" href="#annotating-data"></a>
</h2>
<p>As a part of the Tidyproteomics workflow, we need to update the
<code>gene_name</code> and <code>description</code> annotated terms in
the data imported from FragPipe. To accomplish this, we will use
information from a parsed FASTA file. The parsed FASTA file should
contain three columns: <code>protein</code> identifier,
<code>term</code>, and <code>annotation</code>.</p>
<p>Updating the <code>gene_name</code> and <code>description</code>
annotated terms will allow for easier interpretation and analysis of the
data. The <code>gene_name</code> and <code>description</code> attributes
provide crucial information about the protein, such as its function and
biological role. By updating these attributes with information from the
FASTA file, we can ensure that our data is accurate and informative.</p>
<p>The process of updating the <code>gene_name</code> and
<code>description</code> annotated terms is simple. First, we will parse
the FASTA file to extract the necessary information. Then, we will use
this information to update the corresponding attributes in the imported
data from FragPipe.</p>
<p>It is important to note that the parsed FASTA file must contain
accurate and up-to-date information. If the information in the FASTA
file is outdated or incorrect, the updated <code>gene_name</code> and
<code>description</code> attributes will also be incorrect. Therefore,
it is essential to verify the accuracy of the FASTA file before using it
to update the imported data from FragPipe.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jeffsocal.github.io/tidyproteomics/">tidyproteomics</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download the data</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://ftp.ebi.ac.uk/pride-archive/2016/06/PXD004163/Yan_miR_Protein_table.flatprottable.txt"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">url</span>, destfile <span class="op">=</span> <span class="st">"./data/combined_protein.tsv"</span>, method <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import the data</span></span>
<span><span class="va">data_prot</span> <span class="op">&lt;-</span> <span class="st">"./data/combined_protein.tsv"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">'FragPipe'</span>, <span class="st">'proteins'</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="from-a-fasta-file">From a FASTA File<a class="anchor" aria-label="anchor" href="#from-a-fasta-file"></a>
</h3>
<p>Read in a FASTA file using some “un-exposed” methods in the
<code>tidyproteomics</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_fasta</span> <span class="op">&lt;-</span> <span class="st">"~/Local/data/fasta/uniprot_human-20398_20220920.fasta"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyproteomics</span><span class="fu">:::</span><span class="fu"><a href="../reference/fasta_parse.html">fasta_parse</a></span><span class="op">(</span>as <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>protein <span class="op">=</span> <span class="va">accession</span>, <span class="va">gene_name</span>, <span class="va">description</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gene_name'</span>, <span class="st">'description'</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">'term'</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">'annotation'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_fasta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P68431'</span>, <span class="st">'P62805'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   protein term        annotation  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P62805  gene_name   H4-16       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P62805  description Histone H4  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P68431  gene_name   H3C12       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P68431  description Histone H3.1</span></span></code></pre></div>
<p>Notice the <code>gene_name</code> annotations are different from the
FASTA than from the FragPipe outoput.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_prot</span><span class="op">$</span><span class="va">annotations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P68431'</span>, <span class="st">'P62805'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   protein term        annotation  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P62805  gene_name   H4C1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P62805  description Histone H4  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P68431  gene_name   H3C1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P68431  description Histone H3.1</span></span></code></pre></div>
<p>We can <strong>merge</strong> the annotations,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_new_merged</span> <span class="op">&lt;-</span> <span class="va">data_prot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/annotate.html">annotate</a></span><span class="op">(</span><span class="va">data_fasta</span>, duplicates <span class="op">=</span> <span class="st">'merge'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_new_merged</span><span class="op">$</span><span class="va">annotations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P68431'</span>, <span class="st">'P62805'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   protein term        annotation  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P62805  description Histone H4  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P62805  gene_name   H4C1; H4-16 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P68431  description Histone H3.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P68431  gene_name   H3C1; H3C12</span></span></code></pre></div>
<p>Or we can <strong>replace</strong> the annotations,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_new_replaced</span> <span class="op">&lt;-</span> <span class="va">data_prot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/annotate.html">annotate</a></span><span class="op">(</span><span class="va">data_fasta</span>, duplicates <span class="op">=</span> <span class="st">'replace'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_new_replaced</span><span class="op">$</span><span class="va">annotations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P68431'</span>, <span class="st">'P62805'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   protein term        annotation  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P62805  description Histone H4  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P62805  gene_name   H4-16       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P68431  description Histone H3.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P68431  gene_name   H3C12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="go-annotations">GO Annotations<a class="anchor" aria-label="anchor" href="#go-annotations"></a>
</h3>
<p>To obtain GO annotations, you can visit UniProt’s website and search
for the proteins of interest, such as human proteins. Once you have
found the proteins, you will need to select the “Customize columns”
option to access several options, including Gene Ontology.</p>
<p>After selecting Gene Ontology, you will need to choose the desired
values, such as molecular function, by clicking on them. Once you have
selected your desired values, click on the “Save” button to save your
changes.</p>
<div class="float">
<img src="images/uniprot_search_01.png" style="width:100.0%" alt="Figure 1 - UniProt web search for human proteins"><div class="figcaption"><em>Figure 1 - UniProt web search for human
proteins</em></div>
</div>
<p>Finally, you can download the table as a TSV file by clicking on the
“Download” button. This file will contain all the information you need
about your selected proteins, making it easier to analyze and interpret
the data.</p>
<p>Now that you know how to obtain GO annotations, you can use this
information to enhance your research and analysis. UniProt’s website is
a valuable resource for obtaining information about proteins, and the
ability to customize columns and select desired values makes it even
more useful for researchers and scientists.</p>
<div class="float">
<img src="images/uniprot_search_02.png" style="width:100.0%" alt="Figure 2 - UniProt show table layout with Go annotations"><div class="figcaption"><em>Figure 2 - UniProt show table layout with Go
annotations</em></div>
</div>
<p>Read in the TSV file from the downloaded UniProt table.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_go</span> <span class="op">&lt;-</span> <span class="st">"~/Local/data/uniprotkb_human_AND_reviewed_true_AND_m_2023_10_10.tsv"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_go</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   Entry      Reviewed `Entry Name` `Protein names`  `Gene Names` Organism Length</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A0A087X1C5 reviewed CP2D7_HUMAN  Putative cytoch… CYP2D7       Homo sa…    515</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A0A0B4J2F0 reviewed PIOS1_HUMAN  Protein PIGBOS1… PIGBOS1      Homo sa…     54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> A0A0B4J2F2 reviewed SIK1B_HUMAN  Putative serine… SIK1B        Homo sa…    783</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> A0A0C5B5G6 reviewed MOTSC_HUMAN  Mitochondrial-d… MT-RNR1      Homo sa…     16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> A0A0K2S4Q6 reviewed CD3CH_HUMAN  Protein CD300H … CD300H       Homo sa…    201</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> A0A0U1RRE5 reviewed NBDY_HUMAN   Negative regula… NBDY LINC01… Homo sa…     68</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: `Gene Ontology (molecular function)` &lt;chr&gt;</span></span></span></code></pre></div>
<p>We just need to tidy up that data a bit and get it into the format
needed for attaching the annotations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_go</span> <span class="op">&lt;-</span> <span class="va">data_go</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>protein <span class="op">=</span> <span class="va">Entry</span>,</span>
<span>         molecular_function <span class="op">=</span> <span class="va">`Gene Ontology (molecular function)`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># separate the GO terms so we get 1/row</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_rows.html" class="external-link">separate_rows</a></span><span class="op">(</span><span class="va">molecular_function</span>, sep<span class="op">=</span><span class="st">"\\;\\s"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># remove the [GO:accession]</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>molecular_function <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\s\\[.+"</span>, <span class="st">""</span>, <span class="va">molecular_function</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># pivot to the needed format</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">molecular_function</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">'term'</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">'annotation'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_go</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   protein    term               annotation                                      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A0A087X1C5 molecular_function aromatase activity                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A0A087X1C5 molecular_function heme binding                                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> A0A087X1C5 molecular_function iron ion binding                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> A0A087X1C5 molecular_function oxidoreductase activity, acting on paired donor…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> A0A0B4J2F0 molecular_function <span style="color: #BB0000;">NA</span>                                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> A0A0B4J2F2 molecular_function ATP binding</span></span></code></pre></div>
<p>Looks great!</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_new_go</span> <span class="op">&lt;-</span> <span class="va">data_prot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/annotate.html">annotate</a></span><span class="op">(</span><span class="va">data_go</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_new_go</span><span class="op">$</span><span class="va">annotations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P68431'</span>, <span class="st">'P62805'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   protein term               annotation                         </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P62805  description        Histone H4                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P62805  gene_name          H4C1                               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P62805  molecular_function structural constituent of chromatin</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P68431  description        Histone H3.1                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> P68431  gene_name          H3C1                               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> P68431  molecular_function structural constituent of chromatin</span></span></code></pre></div>
<p>Take it for a test drive by subsetting the data based on a specific
annotation term.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_new_go</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/subset.html">subset</a></span><span class="op">(</span><span class="va">molecular_function</span> <span class="op">==</span> <span class="st">'structural constituent of chromatin'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Origin          FragPipe </span></span>
<span><span class="co">#&gt;                 proteins (23.96 kB) </span></span>
<span><span class="co">#&gt; Composition     6 files </span></span>
<span><span class="co">#&gt;                 2 samples (control, knockdown) </span></span>
<span><span class="co">#&gt; Quantitation    14 proteins </span></span>
<span><span class="co">#&gt;                 2.7 log10 dynamic range </span></span>
<span><span class="co">#&gt;                 16.7% missing values </span></span>
<span><span class="co">#&gt;  *imputed        </span></span>
<span><span class="co">#&gt; Accounting      (3) num_psms num_psms_unique imputed </span></span>
<span><span class="co">#&gt; Annotations     (3) molecular_function description gene_name </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>An enrichment plot for “ion binding” for the annotation
<code>molecular_function</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_new_go</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/subset.html">subset</a></span><span class="op">(</span><span class="va">molecular_function</span> <span class="op"><a href="../reference/grapes-like-grapes.html">%like%</a></span> <span class="st">'ion binding'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/expression.html">expression</a></span><span class="op">(</span><span class="va">knockdown</span><span class="op">/</span><span class="va">control</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/enrichment.html">enrichment</a></span><span class="op">(</span><span class="va">knockdown</span><span class="op">/</span><span class="va">control</span>, </span>
<span>             .term <span class="op">=</span> <span class="st">'molecular_function'</span>,</span>
<span>             .method <span class="op">=</span> <span class="st">'wilcoxon'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_enrichment.html">plot_enrichment</a></span><span class="op">(</span></span>
<span>    <span class="va">knockdown</span><span class="op">/</span><span class="va">control</span>, </span>
<span>    .term <span class="op">=</span> <span class="st">'molecular_function'</span>,</span>
<span>    significance_max <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="annotating_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jeff Jones.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
